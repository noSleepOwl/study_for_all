# REST 与异步
***
## 为什么使用异步机制

>**有时**异步可以为REST服务带来更强大的功能，提高服务的性能以及提升用户体验^[1]^

说到异步可以想到的是线程间的异步操作和ajax请求，在使用场景中，多数是为了耗时操作而产生的，例如：ajax在使用中可以让页面进行局部的更新，从而减少客户的等待时间，使整个网页加载的速度更快，或者个人电脑可以同时进行文件下载、听歌、看书····最大化的进行资源的应用和效率的提升。综上，异步接口的主要目的也很明显即，提高性能和提升用户体验

## 异步服务使用场景
异步使用的场景是有限的，一般的在web应用中不会遇到异步的场景。

**一般请求的处理流程是**

`开始->客户请求->服务端与数据库交互->响应客户端->结束`

**一个可能的异步服务的流程**

1. `客户端请求->服务器接收请求->异步起动任务->响应客户端`

2. `客户端请求 -> 服务端收到任务进度查询请求 -> 查看任务进度 -> 响应客户端任务的执行状态`

>^[2]^异步并非一定可以提高性能。异步提高性能的前提是
>1. 任务的执行时间要远大于创建异步线程所消耗的时间。
>2. 服务器资源在同步阻塞情况下是由资源空闲的

## 设计异步接口
书中对异步接口设计较少的我参照博文[设计异步 RESTful APIs](http://https://juejin.im/entry/5b39e63ae51d455cd054cddd)和[异步 API 的设计](http://www.ruanyifeng.com/blog/2018/12/async-api-design.html)

第一篇博文中提出了几个问题

1. 接口幂等性的保证让客户端生成而是服务端分配？
2. 为什么不选择 WebSocket？
3. 服务端的异步任务如何对任务进度进行记录？
4. 如何让客户端从请求结果中识别异步任务成功还是失败？
5. 如果异步任务失败了，服务端需要对异步任务涉及的资源作何处理？




## 参考

[1] java RESTful Web Service 实战（第2版） P284
[2] java RESTful Web Service 实战（第2版） P287